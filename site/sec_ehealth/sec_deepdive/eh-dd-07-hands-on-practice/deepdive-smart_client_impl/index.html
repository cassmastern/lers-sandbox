
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://cassmastern.github.io/cass-sandbox/sec_ehealth/sec_deepdive/eh-dd-07-hands-on-practice/deepdive-smart_client_impl/" rel="canonical"/>
<link href="../deepdive-smart_client_impl-sample-app/" rel="prev"/>
<link href="../deepdive-smart_client_impl-practical-code-examples/" rel="next"/>
<link href="../../../../img/favicon.ico" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.39" name="generator"/>
<title>SMART Client Implementation (Python) - Ler's Sandbox</title>
<link href="../../../../assets/stylesheets/main.8c3ca2c6.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../../../css/alphabet.css" rel="stylesheet"/>
<link href="../../../../css/diagram-zoom.css" rel="stylesheet"/>
<link href="../../../../css/cm-logo.css" rel="stylesheet"/>
<link href="../../../../css/color-vars.css" rel="stylesheet"/>
<link href="../../../../css/custom-theme-colors.css" rel="stylesheet"/>
<link href="../../../../assets/mkdocs_puml/puml.css" rel="stylesheet"/>
<link href="../../../../assets/mkdocs_puml/interaction.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-GD2XWDMP2E"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-GD2XWDMP2E",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-GD2XWDMP2E",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
</head>
<body data-md-color-accent="custom" data-md-color-primary="custom" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#smart-client-implementation-python">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Ler's Sandbox" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="Ler's Sandbox">
<img alt="logo" src="../../../../img/logo.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Ler's Sandbox
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              SMART Client Implementation (Python)
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="custom" data-md-color-media="" data-md-color-primary="custom" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="custom" data-md-color-media="" data-md-color-primary="custom" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<a aria-label="Share" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="Share">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Ler's Sandbox" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="Ler's Sandbox">
<img alt="logo" src="../../../../img/logo.svg"/>
</a>
    Ler's Sandbox
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../..">
<span class="md-ellipsis">
    HOME
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_about/">
<span class="md-ellipsis">
    ABOUT THIS WEBSITE
  </span>
</a>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            ABOUT THIS WEBSITE
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_about/whatsinhere/">
<span class="md-ellipsis">
    What's in Here?
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_about/roadmap/">
<span class="md-ellipsis">
    Roadmap &amp; Changelog
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_about/feedback/">
<span class="md-ellipsis">
    Feedback
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_cloud/">
<span class="md-ellipsis">
    IN THE CLOUDS
  </span>
</a>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            IN THE CLOUDS
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_cloud/aws-gcp-azure/">
<span class="md-ellipsis">
    Architectures of AWS, GCP, and Azure
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_cloud/aws-gcp-azure_glossary/">
<span class="md-ellipsis">
    Cross-Platform Cloud &amp; DevOps Glossary (AWS, GCP, Azure)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_cloud/aws-gcp-azure_glossary_enhanced/">
<span class="md-ellipsis">
    Cross-Platform Cloud &amp; DevOps Glossary (AWS, GCP, Azure) — Enhanced
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_cloud/jakarta-ee-azure/">
<span class="md-ellipsis">
    A Jakarta Enterprise Application on Azure
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_accss/">
<span class="md-ellipsis">
    ACCESSIBILITY
  </span>
</a>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            ACCESSIBILITY
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_accss/accss_/">
<span class="md-ellipsis">
    Accessibility Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_accss/visuals-for-the-sightless/">
<span class="md-ellipsis">
    Visuals for the Sightless
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_accss/accss_diagram-dilemma/">
<span class="md-ellipsis">
    The Diagramming Dilemma
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_accss/mermaid-beyond-reach/">
<span class="md-ellipsis">
    An Accessible Mermaid Beyond Reach
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_accss/mermaid-captured/">
<span class="md-ellipsis">
    Mermaid Captured
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_accss/mkdocs-mermaid-plantuml-graphviz/">
<span class="md-ellipsis">
    Diagram Accessibility: Current State/Path Forward
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_freeform/">
<span class="md-ellipsis">
    CONCEPTS, ESSAYS, ETC.
  </span>
</a>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            CONCEPTS, ESSAYS, ETC.
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_freeform/ibm-sanfran/">
<span class="md-ellipsis">
    IBM SanFrancisco
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_freeform/ai-accessibility/">
<span class="md-ellipsis">
    Accessibility with AI
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_freeform/ai-accessibility_bus/">
<span class="md-ellipsis">
    Accessibility with AI (Concept Note)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_freeform/gen-ai-landscape-primer/">
<span class="md-ellipsis">
    GenAI Landscape in 2025
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_freeform/identity/">
<span class="md-ellipsis">
    The Long Arc of Digital Identity
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_net-sec/">
<span class="md-ellipsis">
    NETWORKS &amp; SECURITY
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            NETWORKS &amp; SECURITY
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_net-sec/network_data_center/">
<span class="md-ellipsis">
    A Hypothetical Data Centre Network
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_net-sec/network_data_center_stride/">
<span class="md-ellipsis">
    Network Security and Threat Modeling — STRIDE
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_net-sec/network_data_center_mitre/">
<span class="md-ellipsis">
    Network Security and Threat Modeling — MITRE ATT&amp;CK
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_net-sec/saml-admin/">
<span class="md-ellipsis">
    Single Sign-On (SSO) Admin Guide — SAML 2.0 Integration
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../">
<span class="md-ellipsis">
    eHEALTH
  </span>
</a>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            eHEALTH
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    SMART-on-FHIR Deep Dive
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_7_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_2">
<span class="md-nav__icon md-icon"></span>
            SMART-on-FHIR Deep Dive
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../eh-dd-01-foundations/">
<span class="md-ellipsis">
    An Introduction to FHIR
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_2" id="__nav_7_2_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_2">
<span class="md-nav__icon md-icon"></span>
            An Introduction to FHIR
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-01-foundations/deepdive-overview/">
<span class="md-ellipsis">
    Overview of SMART-on-FHIR
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-01-foundations/deepdive-overview-fhir-arch/">
<span class="md-ellipsis">
    SMART-on-FHIR Architecture Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-01-foundations/deepdive-overview-fhir-resources/">
<span class="md-ellipsis">
    Key FHIR Resources
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../eh-dd-02-fhir-data-fundamentals/">
<span class="md-ellipsis">
    FHIR Data Fundamentals
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_3" id="__nav_7_2_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_3">
<span class="md-nav__icon md-icon"></span>
            FHIR Data Fundamentals
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-02-fhir-data-fundamentals/deepdive-fhir-data-types/">
<span class="md-ellipsis">
    FHIR Data Types
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-02-fhir-data-fundamentals/deepdive-fhir-code-systems/">
<span class="md-ellipsis">
    FHIR Terminology Standards
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-02-fhir-data-fundamentals/deepdive-fhir-cardinality/">
<span class="md-ellipsis">
    FHIR Resource Cardinality
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-02-fhir-data-fundamentals/deepdive-complete-resource-example/">
<span class="md-ellipsis">
    Complete FHIR Resource Example
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../eh-dd-03-fhir-resource-relationships/">
<span class="md-ellipsis">
    FHIR Resource Relationships
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_4" id="__nav_7_2_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_4">
<span class="md-nav__icon md-icon"></span>
            FHIR Resource Relationships
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-03-fhir-resource-relationships/deepdive-fhir-resource-relationships/">
<span class="md-ellipsis">
    FHIR Resource Relationships
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-03-fhir-resource-relationships/deepdive-fhir-resource-relationships-comprehensive/">
<span class="md-ellipsis">
    FHIR Comprehensive Resource Relationships
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-03-fhir-resource-relationships/deepdive-fhir-resource-bundles/">
<span class="md-ellipsis">
    FHIR Resource Bundles
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../eh-dd-04-working-with-fhir-apis/">
<span class="md-ellipsis">
    FHIR Resource APIs
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_5" id="__nav_7_2_5_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_5">
<span class="md-nav__icon md-icon"></span>
            FHIR Resource APIs
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-04-working-with-fhir-apis/deepdive-fhir-rest-common-ops/">
<span class="md-ellipsis">
    Common FHIR REST Operations
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-04-working-with-fhir-apis/deepdive-fhir-search-parameters/">
<span class="md-ellipsis">
    FHIR Search Parameters
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-04-working-with-fhir-apis/deepdive-error-handling/">
<span class="md-ellipsis">
    Error Handling and OperationOutcome
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-04-working-with-fhir-apis/deepdive-fhir-validation/">
<span class="md-ellipsis">
    FHIR Validation
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../eh-dd-05-advanced-fhir-concepts/">
<span class="md-ellipsis">
    Advanced FHIR Concepts
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_6" id="__nav_7_2_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_6">
<span class="md-nav__icon md-icon"></span>
            Advanced FHIR Concepts
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-05-advanced-fhir-concepts/eh-dd-05-advanced-intro/">
<span class="md-ellipsis">
    Handling Variation — Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-05-advanced-fhir-concepts/deepdive-fhir-profiles-and-extensions/">
<span class="md-ellipsis">
    FHIR Profiles and Extensions
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2_7" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../eh-dd-06-smart-auth/">
<span class="md-ellipsis">
    SMART Authorization
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_7" id="__nav_7_2_7_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_7">
<span class="md-nav__icon md-icon"></span>
            SMART Authorization
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-06-smart-auth/deepdive-oauth-overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-06-smart-auth/deepdive-oauth-flow/">
<span class="md-ellipsis">
    OAuth 2.0 Flow
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-06-smart-auth/deepdive-smart-launch-flow/">
<span class="md-ellipsis">
    SMART Launch Flow
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-06-smart-auth/deepdive-smart-scopes-and-auth/">
<span class="md-ellipsis">
    SMART Scopes and Authorization
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-06-smart-auth/deepdive-smart-config-discovery/">
<span class="md-ellipsis">
    SMART Configuration Discovery
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-06-smart-auth/deepdive-security-and-access-control/">
<span class="md-ellipsis">
    Security and Access Control
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_7_2_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Hands-On
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_8" id="__nav_7_2_8_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_7_2_8_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_8">
<span class="md-nav__icon md-icon"></span>
            Hands-On
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../deepdive-smart-health-it-sandbox/">
<span class="md-ellipsis">
    Using the SMART Health IT Sandbox
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deepdive-smart_client_impl-sample-app/">
<span class="md-ellipsis">
    Practical Example — a Sample SMART App
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    SMART Client Implementation (Python)
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    SMART Client Implementation (Python)
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#python-example">
<span class="md-ellipsis">
      Python Example
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deepdive-smart_client_impl-practical-code-examples/">
<span class="md-ellipsis">
    Practical Code Examples
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../deepdive-testing-and-debugging/">
<span class="md-ellipsis">
    Testing and Debugging
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2_9" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../eh-dd-08-wrap-up/">
<span class="md-ellipsis">
    Wrap-Up
  </span>
</a>
<label class="md-nav__link" for="__nav_7_2_9" id="__nav_7_2_9_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_9_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_7_2_9">
<span class="md-nav__icon md-icon"></span>
            Wrap-Up
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-08-wrap-up/deepdive-key-takeaways/">
<span class="md-ellipsis">
    Deepdive key takeaways
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../eh-dd-08-wrap-up/deepdive-summary/">
<span class="md-ellipsis">
    Summary
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../sec_integration/">
<span class="md-ellipsis">
    SMART-on-FHIR Integration
  </span>
</a>
<label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_7_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_3">
<span class="md-nav__icon md-icon"></span>
            SMART-on-FHIR Integration
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../sec_integration/quick_ref/">
<span class="md-ellipsis">
    SMART-on-FHIR and Integration Quick Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../sec_integration/smart-fhir-visuals/">
<span class="md-ellipsis">
    SMART-on-FHIR and Integration — Visuals
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../sec_integration/gloss_ontario_halo/">
<span class="md-ellipsis">
    Ontario eHealth &amp; HALO Integration Glossary
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_api/">
<span class="md-ellipsis">
    API DOCUMENTATION
  </span>
</a>
<label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_8">
<span class="md-nav__icon md-icon"></span>
            API DOCUMENTATION
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8_2" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/">
<span class="md-ellipsis">
    COUNTRIES REST API
  </span>
</a>
<label class="md-nav__link" for="__nav_8_2" id="__nav_8_2_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_2">
<span class="md-nav__icon md-icon"></span>
            COUNTRIES REST API
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/api-countries-overview/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_8_2_3" id="__nav_8_2_3_label" tabindex="0">
<span class="md-ellipsis">
    Guides
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_8_2_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_8_2_3">
<span class="md-nav__icon md-icon"></span>
            Guides
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/sec_api_countries_guides/api-countries-guides-quickstart/">
<span class="md-ellipsis">
    Quick Start Guide
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/sec_api_countries_guides/api-countries-guides-filtering/">
<span class="md-ellipsis">
    Advanced Filtering
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/sec_api_countries_guides/api-countries-guides-integration/">
<span class="md-ellipsis">
    Integration Patterns
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8_2_4" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/sec_api_countries_examples/">
<span class="md-ellipsis">
    Examples
  </span>
</a>
<label class="md-nav__link" for="__nav_8_2_4" id="__nav_8_2_4_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_2_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_8_2_4">
<span class="md-nav__icon md-icon"></span>
            Examples
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/sec_api_countries_examples/api-countries-examples-javascript/">
<span class="md-ellipsis">
    JavaScript Examples
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/sec_api_countries_examples/api-countries-examples-python/">
<span class="md-ellipsis">
    Python Examples
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/sec_api_countries_examples/api-countries-examples-usecases/">
<span class="md-ellipsis">
    Real-World Use Cases
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/reference/">
<span class="md-ellipsis">
    Interactive OpenAPI (Swagger) Reference
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_api/sec_api_countries/resources/">
<span class="md-ellipsis">
    Resources &amp; Support
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_8_3" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_api/sec_api_stripe/">
<span class="md-ellipsis">
    STRIPE PAYMENT API
  </span>
</a>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_8_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_8_3">
<span class="md-nav__icon md-icon"></span>
            STRIPE PAYMENT API
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_9" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_cheatsheets/">
<span class="md-ellipsis">
    CHEAT SHEETS
  </span>
</a>
<label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_9_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_9">
<span class="md-nav__icon md-icon"></span>
            CHEAT SHEETS
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_cheatsheets/cheatsheet-docker/">
<span class="md-ellipsis">
    Docker Command Cheatsheet
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_cheatsheets/cheatsheet-kubectl/">
<span class="md-ellipsis">
    Kubectl Command Cheat Sheet
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_cheatsheets/cheatsheet_compound-modifiers/">
<span class="md-ellipsis">
    Compound Modifiers Cheat Sheet
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_10" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../../../../sec_gloss/">
<span class="md-ellipsis">
    GLOSSARIES
  </span>
</a>
<label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="false" aria-labelledby="__nav_10_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_10">
<span class="md-nav__icon md-icon"></span>
            GLOSSARIES
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_gloss/gloss_oss/">
<span class="md-ellipsis">
    Glossary of OSS Terms
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_gloss/gloss_networking/">
<span class="md-ellipsis">
    Glossary of Networking Terms
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_gloss/gloss_kuber/">
<span class="md-ellipsis">
    Glossary of Kubernetes Terms
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../sec_gloss/gloss_cloud-native/">
<span class="md-ellipsis">
    Glossary of Cloud-Native Terms
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#python-example">
<span class="md-ellipsis">
      Python Example
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="smart-client-implementation-python">SMART Client Implementation (Python)</h1>
<h2 id="python-example">Python Example</h2>
<div class="highlight"><pre><span></span><code><span class="sd">"""</span>
<span class="sd">SMART-on-FHIR Client Implementation in Python</span>
<span class="sd">Install dependencies: pip install fhirclient</span>
<span class="sd">"""</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">fhirclient</span><span class="w"> </span><span class="kn">import</span> <span class="n">client</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">fhirclient.models</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">patient</span><span class="p">,</span> <span class="n">observation</span><span class="p">,</span> <span class="n">condition</span><span class="p">,</span> <span class="n">medicationrequest</span><span class="p">,</span>
    <span class="n">encounter</span><span class="p">,</span> <span class="n">procedure</span><span class="p">,</span> <span class="n">allergyintolerance</span><span class="p">,</span> <span class="n">immunization</span><span class="p">,</span>
    <span class="n">diagnosticreport</span><span class="p">,</span> <span class="n">careplan</span>
<span class="p">)</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SmartFhirClient</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Wrapper for SMART-on-FHIR operations"""</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Initialize SMART client</span>

<span class="sd">        Args:</span>
<span class="sd">            settings (dict): Configuration dictionary with:</span>
<span class="sd">                - app_id: Client ID</span>
<span class="sd">                - api_base: FHIR server base URL</span>
<span class="sd">                - redirect_uri: OAuth redirect URI (optional)</span>
<span class="sd">        """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">'app_id'</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'app_id'</span><span class="p">,</span> <span class="s1">'my_app'</span><span class="p">),</span>
            <span class="s1">'api_base'</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'api_base'</span><span class="p">),</span>
            <span class="s1">'redirect_uri'</span><span class="p">:</span> <span class="n">settings</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'redirect_uri'</span><span class="p">,</span> <span class="s1">'http://localhost:8000'</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">smart</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">FHIRClient</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">)</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># PATIENT OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patient</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get patient by ID"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pat</span> <span class="o">=</span> <span class="n">patient</span><span class="o">.</span><span class="n">Patient</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">patient_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">pat</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error reading patient: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">search_patients</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Search for patients</span>

<span class="sd">        Args:</span>
<span class="sd">            **kwargs: Search parameters (name, birthdate, identifier, etc.)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of Patient resources</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search</span> <span class="o">=</span> <span class="n">patient</span><span class="o">.</span><span class="n">Patient</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">patients</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">patients</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error searching patients: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_patient_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pat</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Extract formatted name from patient"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pat</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Unknown"</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">pat</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">given</span> <span class="o">=</span> <span class="s1">' '</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">name</span><span class="o">.</span><span class="n">given</span><span class="p">)</span> <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">given</span> <span class="k">else</span> <span class="s1">''</span>
        <span class="n">family</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">family</span> <span class="ow">or</span> <span class="s1">''</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">given</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">family</span><span class="si">}</span><span class="s2">"</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># OBSERVATION OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_observations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                        <span class="n">date_range</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Get observations for a patient</span>

<span class="sd">        Args:</span>
<span class="sd">            patient_id (str): Patient ID</span>
<span class="sd">            category (str): Observation category (e.g., 'vital-signs', 'laboratory')</span>
<span class="sd">            code (str): LOINC code</span>
<span class="sd">            date_range (tuple): (start_date, end_date) as datetime objects</span>
<span class="sd">            count (int): Maximum number of results</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of Observation resources</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">,</span>
                <span class="s1">'_count'</span><span class="p">:</span> <span class="n">count</span><span class="p">,</span>
                <span class="s1">'_sort'</span><span class="p">:</span> <span class="s1">'-date'</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'category'</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>

            <span class="k">if</span> <span class="n">code</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'code'</span><span class="p">]</span> <span class="o">=</span> <span class="n">code</span>

            <span class="k">if</span> <span class="n">date_range</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">date_range</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"ge</span><span class="si">{</span><span class="n">start</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>
                <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
                    <span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="si">}</span><span class="s2">,le</span><span class="si">{</span><span class="n">end</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">Observation</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">observations</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">observations</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching observations: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_vital_signs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get vital signs for a patient"""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_observations</span><span class="p">(</span>
            <span class="n">patient_id</span><span class="p">,</span> 
            <span class="n">category</span><span class="o">=</span><span class="s1">'vital-signs'</span><span class="p">,</span>
            <span class="n">count</span><span class="o">=</span><span class="n">count</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_lab_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get laboratory results for a patient"""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_observations</span><span class="p">(</span>
            <span class="n">patient_id</span><span class="p">,</span>
            <span class="n">category</span><span class="o">=</span><span class="s1">'laboratory'</span><span class="p">,</span>
            <span class="n">count</span><span class="o">=</span><span class="n">count</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_observation_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Extract value from observation"""</span>
        <span class="k">if</span> <span class="n">obs</span><span class="o">.</span><span class="n">valueQuantity</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">obs</span><span class="o">.</span><span class="n">valueQuantity</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">obs</span><span class="o">.</span><span class="n">valueQuantity</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">"</span>
        <span class="k">elif</span> <span class="n">obs</span><span class="o">.</span><span class="n">valueCodeableConcept</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">obs</span><span class="o">.</span><span class="n">valueCodeableConcept</span><span class="o">.</span><span class="n">coding</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">valueCodeableConcept</span><span class="o">.</span><span class="n">coding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span>
            <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">valueCodeableConcept</span><span class="o">.</span><span class="n">text</span>
        <span class="k">elif</span> <span class="n">obs</span><span class="o">.</span><span class="n">valueString</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">obs</span><span class="o">.</span><span class="n">valueString</span>
        <span class="k">elif</span> <span class="n">obs</span><span class="o">.</span><span class="n">component</span><span class="p">:</span>
            <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">obs</span><span class="o">.</span><span class="n">component</span><span class="p">:</span>
                <span class="n">code_display</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">coding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span> <span class="k">if</span> <span class="n">comp</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">coding</span> <span class="k">else</span> <span class="s2">"Unknown"</span>
                <span class="n">value</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">comp</span><span class="o">.</span><span class="n">valueQuantity</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">comp</span><span class="o">.</span><span class="n">valueQuantity</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">"</span>
                <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">code_display</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="s2">", "</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">"N/A"</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_observation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_data</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Create a new observation</span>

<span class="sd">        Args:</span>
<span class="sd">            obs_data (dict): Observation data as dictionary</span>

<span class="sd">        Returns:</span>
<span class="sd">            Observation: Created observation resource</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">observation</span><span class="o">.</span><span class="n">Observation</span><span class="p">(</span><span class="n">obs_data</span><span class="p">)</span>
            <span class="n">obs</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">obs</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error creating observation: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># CONDITION OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">clinical_status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Get conditions for a patient</span>

<span class="sd">        Args:</span>
<span class="sd">            patient_id (str): Patient ID</span>
<span class="sd">            clinical_status (str): Clinical status filter (active, inactive, resolved)</span>
<span class="sd">            category (str): Category filter</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of Condition resources</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">clinical_status</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'clinical-status'</span><span class="p">]</span> <span class="o">=</span> <span class="n">clinical_status</span>

            <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'category'</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">condition</span><span class="o">.</span><span class="n">Condition</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">conditions</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">conditions</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching conditions: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_active_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get active conditions for a patient"""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_conditions</span><span class="p">(</span><span class="n">patient_id</span><span class="p">,</span> <span class="n">clinical_status</span><span class="o">=</span><span class="s1">'active'</span><span class="p">)</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># MEDICATION OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_medications</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Get medication requests for a patient</span>

<span class="sd">        Args:</span>
<span class="sd">            patient_id (str): Patient ID</span>
<span class="sd">            status (str): Status filter (active, completed, stopped)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of MedicationRequest resources</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">,</span>
                <span class="s1">'_sort'</span><span class="p">:</span> <span class="s1">'-authoredon'</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'status'</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">medicationrequest</span><span class="o">.</span><span class="n">MedicationRequest</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">medications</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">medications</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching medications: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_active_medications</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get active medications for a patient"""</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_medications</span><span class="p">(</span><span class="n">patient_id</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="s1">'active'</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_medication_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">med_request</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Extract medication name from MedicationRequest"""</span>
        <span class="k">if</span> <span class="n">med_request</span><span class="o">.</span><span class="n">medicationCodeableConcept</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">med_request</span><span class="o">.</span><span class="n">medicationCodeableConcept</span><span class="o">.</span><span class="n">coding</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">med_request</span><span class="o">.</span><span class="n">medicationCodeableConcept</span><span class="o">.</span><span class="n">coding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span>
            <span class="k">return</span> <span class="n">med_request</span><span class="o">.</span><span class="n">medicationCodeableConcept</span><span class="o">.</span><span class="n">text</span>
        <span class="k">return</span> <span class="s2">"Unknown medication"</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># ENCOUNTER OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_encounters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">date_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""</span>
<span class="sd">        Get encounters for a patient</span>

<span class="sd">        Args:</span>
<span class="sd">            patient_id (str): Patient ID</span>
<span class="sd">            status (str): Encounter status</span>
<span class="sd">            date_range (tuple): (start_date, end_date)</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: List of Encounter resources</span>
<span class="sd">        """</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">,</span>
                <span class="s1">'_sort'</span><span class="p">:</span> <span class="s1">'-date'</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'status'</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span>

            <span class="k">if</span> <span class="n">date_range</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">date_range</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"ge</span><span class="si">{</span><span class="n">start</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>
                <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
                    <span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="si">}</span><span class="s2">,le</span><span class="si">{</span><span class="n">end</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">encounter</span><span class="o">.</span><span class="n">Encounter</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">encounters</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">encounters</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching encounters: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># PROCEDURE OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_procedures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">date_range</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get procedures for a patient"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">date_range</span><span class="p">:</span>
                <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="n">date_range</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"ge</span><span class="si">{</span><span class="n">start</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>
                <span class="k">if</span> <span class="n">end</span><span class="p">:</span>
                    <span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">search_params</span><span class="p">[</span><span class="s1">'date'</span><span class="p">]</span><span class="si">}</span><span class="s2">,le</span><span class="si">{</span><span class="n">end</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span><span class="si">}</span><span class="s2">"</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">procedure</span><span class="o">.</span><span class="n">Procedure</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">procedures</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">procedures</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching procedures: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># ALLERGY OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_allergies</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">clinical_status</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get allergies for a patient"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">clinical_status</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'clinical-status'</span><span class="p">]</span> <span class="o">=</span> <span class="n">clinical_status</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">allergyintolerance</span><span class="o">.</span><span class="n">AllergyIntolerance</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">allergies</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">allergies</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching allergies: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># IMMUNIZATION OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_immunizations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get immunizations for a patient"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">}</span>
            <span class="n">search</span> <span class="o">=</span> <span class="n">immunization</span><span class="o">.</span><span class="n">Immunization</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">immunizations</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">immunizations</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching immunizations: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># DIAGNOSTIC REPORT OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_diagnostic_reports</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get diagnostic reports for a patient"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">category</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'category'</span><span class="p">]</span> <span class="o">=</span> <span class="n">category</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">diagnosticreport</span><span class="o">.</span><span class="n">DiagnosticReport</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">reports</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">reports</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching diagnostic reports: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># CARE PLAN OPERATIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_care_plans</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Get care plans for a patient"""</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">search_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'patient'</span><span class="p">:</span> <span class="n">patient_id</span><span class="p">}</span>

            <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
                <span class="n">search_params</span><span class="p">[</span><span class="s1">'status'</span><span class="p">]</span> <span class="o">=</span> <span class="n">status</span>

            <span class="n">search</span> <span class="o">=</span> <span class="n">careplan</span><span class="o">.</span><span class="n">CarePlan</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">struct</span><span class="o">=</span><span class="n">search_params</span><span class="p">)</span>
            <span class="n">plans</span> <span class="o">=</span> <span class="n">search</span><span class="o">.</span><span class="n">perform_resources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">smart</span><span class="o">.</span><span class="n">server</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">plans</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Error fetching care plans: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[]</span>

    <span class="c1"># ==========================================</span>
    <span class="c1"># UTILITY FUNCTIONS</span>
    <span class="c1"># ==========================================</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_date</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fhir_date</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Format FHIR date/datetime for display"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fhir_date</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Unknown"</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fhir_date</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromisoformat</span><span class="p">(</span><span class="n">fhir_date</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Z'</span><span class="p">,</span> <span class="s1">'+00:00'</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">'%Y-%m-</span><span class="si">%d</span><span class="s1">'</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">fhir_date</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">fhir_date</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_code_display</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">codeable_concept</span><span class="p">):</span>
<span class="w">        </span><span class="sd">"""Extract display text from CodeableConcept"""</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">codeable_concept</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">"Unknown"</span>

        <span class="k">if</span> <span class="n">codeable_concept</span><span class="o">.</span><span class="n">coding</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">codeable_concept</span><span class="o">.</span><span class="n">coding</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">codeable_concept</span><span class="o">.</span><span class="n">coding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">display</span> <span class="ow">or</span> <span class="n">codeable_concept</span><span class="o">.</span><span class="n">coding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">code</span>

        <span class="k">return</span> <span class="n">codeable_concept</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="s2">"Unknown"</span>


<span class="c1"># ==========================================</span>
<span class="c1"># EXAMPLE USAGE</span>
<span class="c1"># ==========================================</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Example usage of SMART FHIR client"""</span>

    <span class="c1"># Configure client for SMART Health IT sandbox</span>
    <span class="n">settings</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'app_id'</span><span class="p">:</span> <span class="s1">'my_app'</span><span class="p">,</span>
        <span class="s1">'api_base'</span><span class="p">:</span> <span class="s1">'https://launch.smarthealthit.org/v/r4/fhir'</span>
    <span class="p">}</span>

    <span class="c1"># Initialize client</span>
    <span class="n">smart_client</span> <span class="o">=</span> <span class="n">SmartFhirClient</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>

    <span class="c1"># Example patient ID from sandbox</span>
    <span class="n">patient_id</span> <span class="o">=</span> <span class="s1">'smart-1288992'</span>

    <span class="c1"># Get patient demographics</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"PATIENT INFORMATION"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">pat</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_patient</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pat</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Name: </span><span class="si">{</span><span class="n">smart_client</span><span class="o">.</span><span class="n">get_patient_name</span><span class="p">(</span><span class="n">pat</span><span class="p">)</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Gender: </span><span class="si">{</span><span class="n">pat</span><span class="o">.</span><span class="n">gender</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Birth Date: </span><span class="si">{</span><span class="n">pat</span><span class="o">.</span><span class="n">birthDate</span><span class="o">.</span><span class="n">isostring</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">pat</span><span class="o">.</span><span class="n">birthDate</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s1">'Unknown'</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"ID: </span><span class="si">{</span><span class="n">pat</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1"># Get vital signs</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"VITAL SIGNS"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">vitals</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_vital_signs</span><span class="p">(</span><span class="n">patient_id</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">vitals</span><span class="p">:</span>
        <span class="n">code_display</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_code_display</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_observation_value</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">format_date</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">effectiveDateTime</span><span class="o">.</span><span class="n">isostring</span> <span class="k">if</span> <span class="n">obs</span><span class="o">.</span><span class="n">effectiveDateTime</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">code_display</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

    <span class="c1"># Get active conditions</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"ACTIVE CONDITIONS"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">conditions</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_active_conditions</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">conditions</span><span class="p">:</span>
        <span class="n">code_display</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_code_display</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="n">onset</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">format_date</span><span class="p">(</span><span class="n">cond</span><span class="o">.</span><span class="n">onsetDateTime</span><span class="o">.</span><span class="n">isostring</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="s1">'onsetDateTime'</span><span class="p">)</span> <span class="ow">and</span> <span class="n">cond</span><span class="o">.</span><span class="n">onsetDateTime</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">code_display</span><span class="si">}</span><span class="s2"> (Onset: </span><span class="si">{</span><span class="n">onset</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

    <span class="c1"># Get active medications</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"ACTIVE MEDICATIONS"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">medications</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_active_medications</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">med</span> <span class="ow">in</span> <span class="n">medications</span><span class="p">:</span>
        <span class="n">med_name</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_medication_name</span><span class="p">(</span><span class="n">med</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">med</span><span class="o">.</span><span class="n">status</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">med_name</span><span class="si">}</span><span class="s2"> (Status: </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">med</span><span class="o">.</span><span class="n">dosageInstruction</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">med</span><span class="o">.</span><span class="n">dosageInstruction</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dosage</span> <span class="o">=</span> <span class="n">med</span><span class="o">.</span><span class="n">dosageInstruction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">dosage</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"  Dosage: </span><span class="si">{</span><span class="n">dosage</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

    <span class="c1"># Get recent encounters</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"RECENT ENCOUNTERS"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">encounters</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_encounters</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">enc</span> <span class="ow">in</span> <span class="n">encounters</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>  <span class="c1"># Limit to 5</span>
        <span class="n">enc_type</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_code_display</span><span class="p">(</span><span class="n">enc</span><span class="o">.</span><span class="n">type</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">if</span> <span class="n">enc</span><span class="o">.</span><span class="n">type</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">enc</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">"Unknown"</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">enc</span><span class="o">.</span><span class="n">status</span>
        <span class="n">period_start</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">format_date</span><span class="p">(</span><span class="n">enc</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">isostring</span> <span class="k">if</span> <span class="n">enc</span><span class="o">.</span><span class="n">period</span> <span class="ow">and</span> <span class="n">enc</span><span class="o">.</span><span class="n">period</span><span class="o">.</span><span class="n">start</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">enc_type</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">period_start</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

    <span class="c1"># Get allergies</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"ALLERGIES"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">allergies</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_allergies</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">allergy</span> <span class="ow">in</span> <span class="n">allergies</span><span class="p">:</span>
        <span class="n">allergen</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_code_display</span><span class="p">(</span><span class="n">allergy</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
        <span class="n">clinical_status</span> <span class="o">=</span> <span class="n">allergy</span><span class="o">.</span><span class="n">clinicalStatus</span><span class="o">.</span><span class="n">coding</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">code</span> <span class="k">if</span> <span class="n">allergy</span><span class="o">.</span><span class="n">clinicalStatus</span> <span class="ow">and</span> <span class="n">allergy</span><span class="o">.</span><span class="n">clinicalStatus</span><span class="o">.</span><span class="n">coding</span> <span class="k">else</span> <span class="s2">"Unknown"</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">allergen</span><span class="si">}</span><span class="s2"> (Status: </span><span class="si">{</span><span class="n">clinical_status</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>

    <span class="c1"># Get immunizations</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span> <span class="o">+</span> <span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"IMMUNIZATIONS"</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"="</span> <span class="o">*</span> <span class="mi">50</span><span class="p">)</span>
    <span class="n">immunizations</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_immunizations</span><span class="p">(</span><span class="n">patient_id</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">imm</span> <span class="ow">in</span> <span class="n">immunizations</span><span class="p">:</span>
        <span class="n">vaccine</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">get_code_display</span><span class="p">(</span><span class="n">imm</span><span class="o">.</span><span class="n">vaccineCode</span><span class="p">)</span>
        <span class="n">date</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">format_date</span><span class="p">(</span><span class="n">imm</span><span class="o">.</span><span class="n">occurrenceDateTime</span><span class="o">.</span><span class="n">isostring</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">imm</span><span class="p">,</span> <span class="s1">'occurrenceDateTime'</span><span class="p">)</span> <span class="ow">and</span> <span class="n">imm</span><span class="o">.</span><span class="n">occurrenceDateTime</span> <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">vaccine</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">date</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>


<span class="c1"># ==========================================</span>
<span class="c1"># EXAMPLE: CREATING AN OBSERVATION</span>
<span class="c1"># ==========================================</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_blood_pressure_example</span><span class="p">(</span><span class="n">smart_client</span><span class="p">,</span> <span class="n">patient_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Example: Create a blood pressure observation"""</span>

    <span class="n">obs_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">'resourceType'</span><span class="p">:</span> <span class="s1">'Observation'</span><span class="p">,</span>
        <span class="s1">'status'</span><span class="p">:</span> <span class="s1">'final'</span><span class="p">,</span>
        <span class="s1">'category'</span><span class="p">:</span> <span class="p">[{</span>
            <span class="s1">'coding'</span><span class="p">:</span> <span class="p">[{</span>
                <span class="s1">'system'</span><span class="p">:</span> <span class="s1">'http://terminology.hl7.org/CodeSystem/observation-category'</span><span class="p">,</span>
                <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'vital-signs'</span><span class="p">,</span>
                <span class="s1">'display'</span><span class="p">:</span> <span class="s1">'Vital Signs'</span>
            <span class="p">}]</span>
        <span class="p">}],</span>
        <span class="s1">'code'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'coding'</span><span class="p">:</span> <span class="p">[{</span>
                <span class="s1">'system'</span><span class="p">:</span> <span class="s1">'http://loinc.org'</span><span class="p">,</span>
                <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'85354-9'</span><span class="p">,</span>
                <span class="s1">'display'</span><span class="p">:</span> <span class="s1">'Blood pressure panel'</span>
            <span class="p">}],</span>
            <span class="s1">'text'</span><span class="p">:</span> <span class="s1">'Blood pressure'</span>
        <span class="p">},</span>
        <span class="s1">'subject'</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">'reference'</span><span class="p">:</span> <span class="sa">f</span><span class="s1">'Patient/</span><span class="si">{</span><span class="n">patient_id</span><span class="si">}</span><span class="s1">'</span>
        <span class="p">},</span>
        <span class="s1">'effectiveDateTime'</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">(),</span>
        <span class="s1">'component'</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s1">'code'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">'coding'</span><span class="p">:</span> <span class="p">[{</span>
                        <span class="s1">'system'</span><span class="p">:</span> <span class="s1">'http://loinc.org'</span><span class="p">,</span>
                        <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'8480-6'</span><span class="p">,</span>
                        <span class="s1">'display'</span><span class="p">:</span> <span class="s1">'Systolic blood pressure'</span>
                    <span class="p">}]</span>
                <span class="p">},</span>
                <span class="s1">'valueQuantity'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">'value'</span><span class="p">:</span> <span class="mi">120</span><span class="p">,</span>
                    <span class="s1">'unit'</span><span class="p">:</span> <span class="s1">'mmHg'</span><span class="p">,</span>
                    <span class="s1">'system'</span><span class="p">:</span> <span class="s1">'http://unitsofmeasure.org'</span><span class="p">,</span>
                    <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'mm[Hg]'</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="s1">'code'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">'coding'</span><span class="p">:</span> <span class="p">[{</span>
                        <span class="s1">'system'</span><span class="p">:</span> <span class="s1">'http://loinc.org'</span><span class="p">,</span>
                        <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'8462-4'</span><span class="p">,</span>
                        <span class="s1">'display'</span><span class="p">:</span> <span class="s1">'Diastolic blood pressure'</span>
                    <span class="p">}]</span>
                <span class="p">},</span>
                <span class="s1">'valueQuantity'</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s1">'value'</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                    <span class="s1">'unit'</span><span class="p">:</span> <span class="s1">'mmHg'</span><span class="p">,</span>
                    <span class="s1">'system'</span><span class="p">:</span> <span class="s1">'http://unitsofmeasure.org'</span><span class="p">,</span>
                    <span class="s1">'code'</span><span class="p">:</span> <span class="s1">'mm[Hg]'</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>

    <span class="n">new_obs</span> <span class="o">=</span> <span class="n">smart_client</span><span class="o">.</span><span class="n">create_observation</span><span class="p">(</span><span class="n">obs_data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">new_obs</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Created observation with ID: </span><span class="si">{</span><span class="n">new_obs</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_obs</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Practical Example — a Sample SMART App" class="md-footer__link md-footer__link--prev" href="../deepdive-smart_client_impl-sample-app/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Practical Example — a Sample SMART App
              </div>
</div>
</a>
<a aria-label="Next: Practical Code Examples" class="md-footer__link md-footer__link--next" href="../deepdive-smart_client_impl-practical-code-examples/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Practical Code Examples
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<div class="md-consent" data-md-component="consent" hidden="" id="__consent">
<div class="md-consent__overlay"></div>
<aside class="md-consent__inner">
<form class="md-consent__form md-grid md-typeset" name="consent">
<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.
</p>
<input class="md-toggle" id="__settings" type="checkbox"/>
<div class="md-consent__settings">
<ul class="task-list">
<li class="task-list-item">
<label class="task-list-control">
<input checked="" name="analytics" type="checkbox"/>
<span class="task-list-indicator"></span>
          Google Analytics
        </label>
</li>
</ul>
</div>
<div class="md-consent__controls">
<button class="md-button md-button--primary">Accept</button>
<label class="md-button" for="__settings">Manage settings</label>
</div>
</form>
</aside>
</div>
<script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
<script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.top", "navigation.footer", "navigation.indexes", "search.highlight", "search.suggest", "search.share", "content.code.copy", "content.code.select"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../../assets/javascripts/bundle.525ec568.min.js"></script>
<script src="../../../../js/diagram-utils.js"></script>
<script src="../../../../js/seamaiden.js"></script>
<script src="../../../../js/diagram-theme-switcher.js"></script>
<script src="../../../../js/diagram-zoom.js"></script>
<script src="../../../../js/alphabet-auto.js"></script>
<script src="../../../../js/open_in_new_tab.js"></script>
<script src="../../../../assets/mkdocs_puml/puml.js"></script>
<script src="https://unpkg.com/@panzoom/panzoom@4.5.1/dist/panzoom.min.js"></script>
<script src="../../../../assets/mkdocs_puml/interaction.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>